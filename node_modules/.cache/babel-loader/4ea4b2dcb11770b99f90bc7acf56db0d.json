{"ast":null,"code":"var _jsxFileName = \"/Users/riannacleary/Desktop/mod5/galaxybnb_frontend/src/components/PlanetLocations.jsx\";\nimport React, { Component } from 'react';\nimport { Grid, Image, Card, Button, Icon, Modal, Header } from 'semantic-ui-react';\nimport Emoji from './Emoji';\nimport ReviewForm from './ReviewForm';\nimport StripeCheckout from 'react-stripe-checkout'; // import Review from './Review'\n\nclass PlanetLocations extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      open: false,\n      location_id: 0\n    };\n\n    this.open = () => this.setState({\n      open: true\n    });\n\n    this.close = () => this.setState({\n      open: false\n    });\n\n    this.sendData = planetObj => {\n      this.props.getPlanetObj(planetObj);\n    };\n\n    this.renderPlanetNames = () => {\n      return this.props.stateFromMain.planets.map(planet => {\n        return planet ? planet.name : 'meow';\n      });\n    };\n\n    this.handleClick = evt => {\n      // console.log(this.state.location_id, this.props.stateFromMain.token)\n      // let {token} = this.props.stateFromMain\n      // if (token) {\n      fetch('http://localhost:4000/bookings', {\n        method: 'POST',\n        headers: {\n          'content-type': 'application/json',\n          'Authorization': `bearer ${this.props.stateFromMain.token}`\n        },\n        body: JSON.stringify({\n          location_id: this.state.location_id,\n          datesRange: this.props.stateFromMain.datesRange,\n          numOfTravelers: this.props.stateFromMain.numOfTravelers\n        })\n      }).then(r => r.json()) // .then(console.log)\n      .then(bookingObj => {\n        this.props.addBooking(bookingObj);\n      });\n    };\n\n    this.onToken = token => {\n      const charge = {\n        token: token.id\n      };\n      let location_id = this.state.location_id;\n      const config = {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          charge: charge,\n          location_id,\n          numOfTravelers: this.props.stateFromMain.numOfTravelers\n        })\n      }; // debugger\n\n      fetch('http://localhost:4000/charges', config).then(res => res.json()).then(charge => {\n        if (charge) {\n          this.handleClick();\n        }\n      });\n    };\n\n    this.nestedModal = () => {\n      const {\n        open\n      } = this.state;\n      return React.createElement(Modal, {\n        open: open,\n        onOpen: this.open,\n        onClose: this.close,\n        size: \"small\",\n        trigger: React.createElement(StripeCheckout, {\n          token: this.onToken,\n          stripeKey: process.env.REACT_APP_STRIPE_API_KEY,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 106\n          },\n          __self: this\n        }, React.createElement(Button, {\n          disabled: this.props.stateFromMain.token ? false : true,\n          circular: true,\n          inverted: true,\n          color: \"red\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 109\n          },\n          __self: this\n        }, \"Book Location \", React.createElement(Icon, {\n          name: \"right chevron\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114\n          },\n          __self: this\n        }))),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      });\n    };\n\n    this.handleBooking = id => {\n      this.setState({\n        location_id: id\n      });\n    };\n\n    this.renderLocations = state => {\n      let {\n        datesRange,\n        numOfTravelers\n      } = this.props.stateFromMain;\n      let {\n        name\n      } = this.props.stateFromMain.planetObj;\n      return this.props.stateFromMain.planetObj.locations ? this.props.stateFromMain.planetObj.locations.map(locationObj => {\n        return React.createElement(Grid.Column, {\n          key: locationObj.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132\n          },\n          __self: this\n        }, React.createElement(Card.Group, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133\n          },\n          __self: this\n        }, React.createElement(Card, {\n          centered: true,\n          stackable: \"true\",\n          itemsperrow: 3,\n          color: \"black\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 134\n          },\n          __self: this\n        }, React.createElement(Image, {\n          src: locationObj.image,\n          wrapped: true,\n          ui: false,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135\n          },\n          __self: this\n        }), React.createElement(Card.Content, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 136\n          },\n          __self: this\n        }, React.createElement(\"h1\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137\n          },\n          __self: this\n        }, locationObj.name), React.createElement(Card.Header, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138\n          },\n          __self: this\n        }, \"&\", locationObj.price, \" galactic credits\"), React.createElement(Modal, {\n          trigger: React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 140\n            },\n            __self: this\n          }, React.createElement(Button, {\n            animated: true,\n            inverted: true,\n            color: \"red\",\n            size: \"small\",\n            onClick: () => this.handleBooking(locationObj.id),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 141\n            },\n            __self: this\n          }, React.createElement(Button.Content, {\n            visible: true,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 142\n            },\n            __self: this\n          }, \"Board Ship\"), React.createElement(Button.Content, {\n            hidden: true,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 143\n            },\n            __self: this\n          }, React.createElement(Emoji, {\n            symbol: \"\\uD83D\\uDE80\\uD83D\\uDE80\\uD83D\\uDE80\",\n            label: \"spaceship\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 144\n            },\n            __self: this\n          })))),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        }, React.createElement(Modal.Header, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 147\n          },\n          __self: this\n        }, \"Confirmation\"), React.createElement(Modal.Content, {\n          image: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 148\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"image\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149\n          },\n          __self: this\n        }, React.createElement(Image, {\n          wrapped: true,\n          size: \"medium\",\n          src: \"../baby_yoda.png\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 150\n          },\n          __self: this\n        })), React.createElement(Modal.Description, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152\n          },\n          __self: this\n        }, React.createElement(\"h1\", {\n          className: \"planet-name\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153\n          },\n          __self: this\n        }, \"Planet: \", name), React.createElement(\"h1\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, \"Location: \", locationObj.name), React.createElement(\"h2\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 155\n          },\n          __self: this\n        }, \"Date Range: \", datesRange), React.createElement(\"h3\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, \"Number of Travelers: \", numOfTravelers), React.createElement(\"h3\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157\n          },\n          __self: this\n        }, \"Price: \", locationObj.price * numOfTravelers))), React.createElement(Modal.Actions, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 160\n          },\n          __self: this\n        }, this.nestedModal())), React.createElement(Modal, {\n          trigger: React.createElement(Button, {\n            inverted: true,\n            color: \"red\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 166\n            },\n            __self: this\n          }, React.createElement(Button.Content, {\n            visible: true,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 167\n            },\n            __self: this\n          }, \"Reviews\")),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165\n          },\n          __self: this\n        }, React.createElement(Modal.Header, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170\n          },\n          __self: this\n        }, locationObj.name), React.createElement(Modal.Content, {\n          image: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171\n          },\n          __self: this\n        }, React.createElement(Image, {\n          wrapped: true,\n          size: \"medium\",\n          src: locationObj.image,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 172\n          },\n          __self: this\n        }), React.createElement(Modal.Description, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 173\n          },\n          __self: this\n        }, React.createElement(Header, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 174\n          },\n          __self: this\n        }), locationObj.reviews.map(review => {\n          return React.createElement(\"p\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 176\n            },\n            __self: this\n          }, review.rating, \" - me\");\n        }), React.createElement(ReviewForm, {\n          token: this.props.stateFromMain.token,\n          addReview: this.props.addReview,\n          locationId: locationObj.id,\n          error_message: this.props.stateFromMain.error_message,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178\n          },\n          __self: this\n        }))))))));\n      }) : 'The force is not with you.';\n    };\n  }\n\n  componentDidMount() {\n    // debugger;\n    let planetId = this.props.match.params.id; // console.log(planetId)\n    // debugger\n\n    fetch(`http://localhost:4000/planets/${planetId}`).then(r => r.json()).then(planetObj => {\n      this.sendData(planetObj);\n    });\n  }\n\n  render() {\n    // debugger;\n    // console.log('STATE FROM PLANET_LOCATIONS', this.state.planetObj)\n    // console.log(this.props.stateFromMain.planetObj.image);\n    // console.log(this.state);\n    // console.log('PROPS FROM PLANET_LOCATIONS', this.props.stateFromMain.planetObj.locations)\n    let {\n      name\n    } = this.props.stateFromMain.planetObj;\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      centered: true,\n      columns: 2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, React.createElement(Grid.Column, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, \"Planet \", name), React.createElement(Image, {\n      src: this.props.stateFromMain.planetObj.image,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    })), React.createElement(Grid.Row, {\n      centered: true,\n      columns: 4,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    })), this.renderLocations());\n  }\n\n}\n\nexport default PlanetLocations;","map":{"version":3,"sources":["/Users/riannacleary/Desktop/mod5/galaxybnb_frontend/src/components/PlanetLocations.jsx"],"names":["React","Component","Grid","Image","Card","Button","Icon","Modal","Header","Emoji","ReviewForm","StripeCheckout","PlanetLocations","state","open","location_id","setState","close","sendData","planetObj","props","getPlanetObj","renderPlanetNames","stateFromMain","planets","map","planet","name","handleClick","evt","fetch","method","headers","token","body","JSON","stringify","datesRange","numOfTravelers","then","r","json","bookingObj","addBooking","onToken","charge","id","config","res","nestedModal","process","env","REACT_APP_STRIPE_API_KEY","handleBooking","renderLocations","locations","locationObj","image","price","reviews","review","rating","addReview","error_message","componentDidMount","planetId","match","params","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Grid, Image, Card, Button, Icon, Modal, Header } from 'semantic-ui-react'\nimport Emoji from './Emoji'\nimport ReviewForm from './ReviewForm'\nimport StripeCheckout from 'react-stripe-checkout'\n// import Review from './Review'\n\n\n\nclass PlanetLocations extends Component {\n\n  state = {\n    open: false,\n    location_id: 0\n  }\n\n  open = () => this.setState({ open: true })\n  close = () => this.setState({ open: false })\n\n  sendData = (planetObj) => {\n    this.props.getPlanetObj(planetObj);\n  }\n\n  componentDidMount() {\n    // debugger;\n    let planetId = this.props.match.params.id;\n    // console.log(planetId)\n    // debugger\n    fetch(`http://localhost:4000/planets/${planetId}`)\n    .then(r => r.json())\n    .then(planetObj => {\n      this.sendData(planetObj)\n    })\n  }\n\n  renderPlanetNames = () => {\n    return this.props.stateFromMain.planets.map((planet) => {\n      return (\n        planet ? planet.name : 'meow'\n      )\n    })\n  }\n\n  handleClick = (evt) => {\n    // console.log(this.state.location_id, this.props.stateFromMain.token)\n    // let {token} = this.props.stateFromMain\n\n    // if (token) {\n      fetch('http://localhost:4000/bookings', {\n        method: 'POST',\n        headers: {\n          'content-type': 'application/json',\n          'Authorization': `bearer ${this.props.stateFromMain.token}`\n        },\n        body: JSON.stringify({\n          location_id: this.state.location_id,\n          datesRange: this.props.stateFromMain.datesRange,\n          numOfTravelers: this.props.stateFromMain.numOfTravelers\n        })\n      })\n      .then(r => r.json())\n      // .then(console.log)\n      .then(bookingObj => {\n        this.props.addBooking(bookingObj)\n      })\n  }\n\n  // STRIPE FETCH\n\n  onToken = (token) => {\n    const charge = {\n      token: token.id\n    };\n    let location_id = this.state.location_id\n    const config = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        charge: charge,\n        location_id,\n        numOfTravelers: this.props.stateFromMain.numOfTravelers\n      })\n  }\n  // debugger\n  fetch('http://localhost:4000/charges', config)\n    .then(res => res.json())\n    .then(charge => {\n      if (charge) {\n        this.handleClick()\n      }\n    })\n\n  }\n\n  nestedModal = () => {\n   const { open } = this.state\n\n    return  <Modal\n      open={open}\n      onOpen={this.open}\n      onClose={this.close}\n      size='small'\n      trigger={\n        <StripeCheckout\n          token={this.onToken}\n          stripeKey={process.env.REACT_APP_STRIPE_API_KEY}>\n        <Button\n          disabled={ this.props.stateFromMain.token ? false : true}\n          circular={true}\n          inverted color='red'\n        >\n        Book Location <Icon name='right chevron' />\n        </Button>\n      </StripeCheckout>\n      }\n    >\n    </Modal>\n  }\n\n  handleBooking = (id) => {\n    this.setState({\n      location_id: id\n    })\n  }\n\n  renderLocations = (state) => {\n    let {datesRange, numOfTravelers} = this.props.stateFromMain\n    let {name} = this.props.stateFromMain.planetObj\n      return this.props.stateFromMain.planetObj.locations ? this.props.stateFromMain.planetObj.locations.map((locationObj) => {\n        return <Grid.Column key={locationObj.id}>\n          <Card.Group >\n           <Card centered={true} stackable='true' itemsperrow={3} color='black'>\n            <Image src={locationObj.image} wrapped ui={false} />\n            <Card.Content>\n              <h1>{locationObj.name}</h1>\n                <Card.Header>&{locationObj.price} galactic credits</Card.Header>\n              <Modal trigger={\n                <div>\n                <Button animated inverted color='red' size='small' onClick={() => this.handleBooking(locationObj.id)}\n                ><Button.Content visible>Board Ship</Button.Content>\n                  <Button.Content hidden>\n                    <Emoji symbol=\"🚀🚀🚀\" label=\"spaceship\"/>\n                  </Button.Content></Button>\n                </div>}>\n                <Modal.Header>Confirmation</Modal.Header>\n                  <Modal.Content image>\n                    <div className='image'>\n                      <Image wrapped size='medium' src='../baby_yoda.png' />\n                    </div>\n                    <Modal.Description >\n                    <h1 className='planet-name'>Planet: { name }</h1>\n                    <h1>Location: {locationObj.name}</h1>\n                    <h2>Date Range: { datesRange }</h2>\n                    <h3>Number of Travelers: { numOfTravelers }</h3>\n                    <h3>Price: {locationObj.price * numOfTravelers}</h3>\n                    </Modal.Description>\n                  </Modal.Content>\n                  <Modal.Actions>\n                    {this.nestedModal()}\n                  </Modal.Actions>\n              </Modal>\n\n              <Modal trigger={\n                <Button inverted color='red'>\n                <Button.Content visible>Reviews</Button.Content>\n                </Button>\n                }>\n              <Modal.Header>{locationObj.name}</Modal.Header>\n                <Modal.Content image>\n                  <Image wrapped size='medium' src={locationObj.image} />\n                  <Modal.Description>\n                  <Header></Header>\n                  {locationObj.reviews.map((review) => {\n                    return <p>{review.rating} - me</p>\n                  })}\n                  <ReviewForm token={this.props.stateFromMain.token} addReview={this.props.addReview} locationId={locationObj.id} error_message={this.props.stateFromMain.error_message}/>\n\n                 </Modal.Description>\n               </Modal.Content>\n              </Modal>\n              </Card.Content>\n             </Card>\n             </Card.Group>\n          </Grid.Column>\n\n      }) : 'The force is not with you.'\n  }\n\n\n  render() {\n    // debugger;\n    // console.log('STATE FROM PLANET_LOCATIONS', this.state.planetObj)\n    // console.log(this.props.stateFromMain.planetObj.image);\n    // console.log(this.state);\n    // console.log('PROPS FROM PLANET_LOCATIONS', this.props.stateFromMain.planetObj.locations)\n    let {name} = this.props.stateFromMain.planetObj\n      return (\n        <div >\n        <Grid centered columns={2}>\n        <Grid.Column>\n        <h1>Planet {name}</h1>\n          <Image src={this.props.stateFromMain.planetObj.image} />\n        </Grid.Column>\n        <Grid.Row centered columns={4}>\n        </Grid.Row>\n        </Grid>\n        {this.renderLocations()}\n        </div>\n      );\n  }\n}\n\n\nexport default PlanetLocations;\n"]},"metadata":{},"sourceType":"module"}